!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):e.vue2Dropzone=o()}(this,function(){"use strict";var e={getSignedURL:function(e,o){e.name,e.type;return new Promise(function(e,n){var t=new XMLHttpRequest;t.open("POST",o),t.onload=function(){200==t.status?e(JSON.parse(t.response)):n(t.statusText)},t.onerror=function(e){console.error("Network Error : Could not send request to AWS (Maybe CORS errors)"),n(e)},t.send()})},sendFile:function(e,o){var n=new FormData;return this.getSignedURL(e,o).then(function(o){var t=o.signature;return Object.keys(t).forEach(function(o){"key"==o?n.append("key",e.name):"Content-Type"==o?n.append("Content-Type",e.type):n.append(o,t[o])}),n.append("file",e),new Promise(function(e,t){var i=new XMLHttpRequest;i.open("POST",o.postEndpoint),i.onload=function(){if(201==i.status){var o=(n=(new window.DOMParser).parseFromString(i.response,"text/xml")).firstChild.children[0].innerHTML;e({success:!0,message:o})}else{var n=(new window.DOMParser).parseFromString(i.response,"text/xml"),s=n.firstChild.children[0].innerHTML;t({success:!1,message:s+". Request is marked as resolved when returns as status 201"})}},i.onerror=function(e){var o=(new window.DOMParser).parseFromString(i.response,"text/xml").firstChild.children[1].innerHTML;t({success:!1,message:o})},i.send(n)})}).catch(function(e){return e})}};return{render:function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"dropzoneElement",class:{"vue-dropzone dropzone":this.includeStyling},attrs:{id:this.id}})},staticRenderFns:[],props:{id:{type:String,required:!0},options:{type:Object,required:!0},includeStyling:{type:Boolean,default:!0,required:!1},awss3:{type:Object,required:!1,default:null},destroyDropzone:{type:Boolean,default:!0,required:!1}},data:function(){return{isS3:!1,wasQueueAutoProcess:!0}},computed:{dropzoneSettings:function(){var e={thumbnailWidth:200,thumbnailHeight:200};return Object.keys(this.options).forEach(function(o){e[o]=this.options[o]},this),null!==this.awss3&&(e.autoProcessQueue=!1,this.isS3=!0,void 0!==this.options.autoProcessQueue&&(this.wasQueueAutoProcess=this.options.autoProcessQueue)),e}},methods:{manuallyAddFile:function(e,o){e.manuallyAdded=!0,this.dropzone.emit("addedfile",e),o&&this.dropzone.emit("thumbnail",e,o);for(var n=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),t=0;t<n.length;t++)n[t].style.width=this.dropzoneSettings.thumbnailWidth+"px",n[t].style.height=this.dropzoneSettings.thumbnailHeight+"px",n[t].style["object-fit"]="contain";this.dropzone.emit("complete",e),this.dropzone.options.maxFiles&&this.dropzone.options.maxFiles--,this.dropzone.files.push(e),this.$emit("vdropzone-file-added-manually",e)},setOption:function(e,o){this.dropzone.options[e]=o},removeAllFiles:function(e){this.dropzone.removeAllFiles(e)},processQueue:function(){var e=this,o=this.dropzone;this.isS3&&!this.wasQueueAutoProcess?this.getQueuedFiles().forEach(function(o){e.getSignedAndUploadToS3(o)}):this.dropzone.processQueue(),this.dropzone.on("success",function(){o.options.autoProcessQueue=!0}),this.dropzone.on("queuecomplete",function(){o.options.autoProcessQueue=!1})},init:function(){return this.dropzone.init()},destroy:function(){return this.dropzone.destroy()},updateTotalUploadProgress:function(){return this.dropzone.updateTotalUploadProgress()},getFallbackForm:function(){return this.dropzone.getFallbackForm()},getExistingFallback:function(){return this.dropzone.getExistingFallback()},setupEventListeners:function(){return this.dropzone.setupEventListeners()},removeEventListeners:function(){return this.dropzone.removeEventListeners()},disable:function(){return this.dropzone.disable()},enable:function(){return this.dropzone.enable()},filesize:function(e){return this.dropzone.filesize(e)},accept:function(e,o){return this.dropzone.accept(e,o)},addFile:function(e){return this.dropzone.addFile(e)},removeFile:function(e){this.dropzone.removeFile(e)},getAcceptedFiles:function(){return this.dropzone.getAcceptedFiles()},getRejectedFiles:function(){return this.dropzone.getRejectedFiles()},getFilesWithStatus:function(){return this.dropzone.getFilesWithStatus()},getQueuedFiles:function(){return this.dropzone.getQueuedFiles()},getUploadingFiles:function(){return this.dropzone.getUploadingFiles()},getAddedFiles:function(){return this.dropzone.getAddedFiles()},getActiveFiles:function(){return this.dropzone.getActiveFiles()},getSignedAndUploadToS3:function(o){var n=this;e.sendFile(o,this.awss3.signingURL).then(function(e){e.success?(o.s3ObjectLocation=e.message,setTimeout(function(){return n.dropzone.processFile(o)}),n.$emit("vdropzone-s3-upload-success",e.message)):"undefined"!=typeof message?n.$emit("vdropzone-s3-upload-error",e.message):n.$emit("vdropzone-s3-upload-error","Network Error : Could not send request to AWS. (Maybe CORS error)")}).catch(function(e){alert(e)})},setAWSSigningURL:function(e){this.isS3&&(this.awss3.signingURL=e)}},mounted:function(){if(!this.$isServer||!this.hasBeenMounted){this.hasBeenMounted=!0,Dropzone.autoDiscover=!1,this.dropzone=new Dropzone(this.$refs.dropzoneElement,this.dropzoneSettings);var e=this;this.dropzone.on("thumbnail",function(o,n){e.$emit("vdropzone-thumbnail",o,n)}),this.dropzone.on("addedfile",function(o){e.duplicateCheck&&this.files.length&&this.files.forEach(function(n){n.name===o.name&&(this.removeFile(o),e.$emit("duplicate-file",o))},this),e.$emit("vdropzone-file-added",o),e.isS3&&e.wasQueueAutoProcess&&e.getSignedAndUploadToS3(o)}),this.dropzone.on("addedfiles",function(o){e.$emit("vdropzone-files-added",o)}),this.dropzone.on("removedfile",function(o){e.$emit("vdropzone-removed-file",o),o.manuallyAdded&&e.dropzone.options.maxFiles++}),this.dropzone.on("success",function(o,n){e.$emit("vdropzone-success",o,n),e.isS3&&e.wasQueueAutoProcess&&e.setOption("autoProcessQueue",!1)}),this.dropzone.on("successmultiple",function(o,n){e.$emit("vdropzone-success-multiple",o,n)}),this.dropzone.on("error",function(o,n,t){e.$emit("vdropzone-error",o,n,t)}),this.dropzone.on("errormultiple",function(o,n,t){e.$emit("vdropzone-error-multiple",o,n,t)}),this.dropzone.on("sending",function(o,n,t){e.isS3&&t.append("s3ObjectLocation",o.s3ObjectLocation),e.$emit("vdropzone-sending",o,n,t)}),this.dropzone.on("sendingmultiple",function(o,n,t){e.$emit("vdropzone-sending-multiple",o,n,t)}),this.dropzone.on("complete",function(o){e.$emit("vdropzone-complete",o)}),this.dropzone.on("completemultiple",function(o){e.$emit("vdropzone-complete-multiple",o)}),this.dropzone.on("canceled",function(o){e.$emit("vdropzone-canceled",o)}),this.dropzone.on("canceledmultiple",function(o){e.$emit("vdropzone-canceled-multiple",o)}),this.dropzone.on("maxfilesreached",function(o){e.$emit("vdropzone-max-files-reached",o)}),this.dropzone.on("maxfilesexceeded",function(o){e.$emit("vdropzone-max-files-exceeded",o)}),this.dropzone.on("processing",function(o){e.$emit("vdropzone-processing",o)}),this.dropzone.on("processing",function(o){e.$emit("vdropzone-processing",o)}),this.dropzone.on("processingmultiple",function(o){e.$emit("vdropzone-processing-multiple",o)}),this.dropzone.on("uploadprogress",function(o,n,t){e.$emit("vdropzone-upload-progress",o,n,t)}),this.dropzone.on("totaluploadprogress",function(o,n,t){e.$emit("vdropzone-total-upload-progress",o,n,t)}),this.dropzone.on("reset",function(){e.$emit("vdropzone-reset")}),this.dropzone.on("queuecomplete",function(){e.$emit("vdropzone-queuecomplete")}),this.dropzone.on("drop",function(o){e.$emit("vdropzone-drop",o)}),this.dropzone.on("dragstart",function(o){e.$emit("vdropzone-drag-start",o)}),this.dropzone.on("dragend",function(o){e.$emit("vdropzone-drag-end",o)}),this.dropzone.on("dragenter",function(o){e.$emit("vdropzone-drag-enter",o)}),this.dropzone.on("dragover",function(o){e.$emit("vdropzone-drag-over",o)}),this.dropzone.on("dragleave",function(o){e.$emit("vdropzone-drag-leave",o)}),e.$emit("vdropzone-mounted")}},beforeDestroy:function(){this.destroyDropzone&&this.dropzone.destroy()}}});
//# sourceMappingURL=vue2Dropzone.js.map
